{"version":3,"file":"login.js","sources":["components/login/login.ts"],"sourcesContent":["import { getToken, setToken } from '@/common/storage';\nimport api from '@/api/login';\n\n/**\n * 登录\n */\nexport default async () => {\n    const token = getToken();\n\n    if (token) {\n        return;\n    }\n\n    try {\n        const loginRes: any = await new Promise((resolve, reject) => {\n            uni.login({\n                success: (res) => resolve(res),\n                fail: (err) => reject(err)\n            });\n        });\n        \n        const { code } = loginRes;\n        const res = await api.login(code);\n        \n        if (!res) {\n            return;\n        }\n        \n        setToken(res.token);\n    } catch (error) {\n        console.error('登录失败:', error);\n    }\n}\n"],"names":["getToken","uni","res","api","setToken"],"mappings":";;;;AAMA,MAAA,QAAe,YAAY;AACvB,QAAM,QAAQA,eAAAA;AAEd,MAAI,OAAO;AACP;AAAA,EACJ;AAEI,MAAA;AACA,UAAM,WAAgB,MAAM,IAAI,QAAQ,CAAC,SAAS,WAAW;AACzDC,oBAAAA,MAAI,MAAM;AAAA,QACN,SAAS,CAACC,SAAQ,QAAQA,IAAG;AAAA,QAC7B,MAAM,CAAC,QAAQ,OAAO,GAAG;AAAA,MAAA,CAC5B;AAAA,IAAA,CACJ;AAEK,UAAA,EAAE,KAAS,IAAA;AACjB,UAAM,MAAM,MAAMC,UAAAA,IAAI,MAAM,IAAI;AAEhC,QAAI,CAAC,KAAK;AACN;AAAA,IACJ;AAEAC,4BAAS,IAAI,KAAK;AAAA,WACb,OAAO;AACZH,kBAAA,MAAc,MAAA,SAAA,mCAAA,SAAS,KAAK;AAAA,EAChC;AACJ;;"}