{"version":3,"file":"upload.js","sources":["common/upload.ts"],"sourcesContent":["import { getApplicationInfo } from '@/common/storage';\nimport {common} from '@/api/index'\n\n/**\n * 上传文件\n * @param options\n */\nexport default async (file: ArrayBuffer, fileExt: string, contentType: string, uploadPath: string, uploadProgress?: (progress: number) => void) => {\n    let applicationInfo = getApplicationInfo();\n\tapplicationInfo = {\n\t\tid: '1',\n\t\tname: \"\",\n\t\tuploadType: 'tencent_cloud_cos'\n\t}\n\n\tif (applicationInfo.uploadType === 'system') {\n\t\t// 上传到server\n\t\tconst fileUrls = await common.uploadToServer(file, uploadProgress);\n\t\treturn fileUrls[0];\n\t} else {\n\t\t// 上传到云服务\n\t\t// 获取上传url\n\t\tconst uploadUrlInfo = await common.getUploadUrls([{\n\t\t\textension: fileExt,\n\t\t\tpath: uploadPath\n\t\t}]);\n\n\t\t// 上传失败\n\t\tif (!uploadUrlInfo || uploadUrlInfo.urls.length === 0) {\n\t\t\treturn;\n\t\t}\n\n\t\tfor (const uploadUrl of uploadUrlInfo.urls) {\n\t\t\tswitch (applicationInfo.uploadType) {\n\t\t\t\tcase 'tencent_cloud_cos':\n\t\t\t\t\tawait common.uploadCOS(file, contentType, uploadUrl.uploadUrl, uploadUrlInfo.headers, uploadProgress);\n\n\t\t\t\t\treturn uploadUrl.url;\n\t\t\t\tdefault:\n\t\t\t\t\tuni.showToast({\n\t\t\t\t\t    title: '暂不支持当前上传类型',\n\t\t\t\t\t    icon: 'none'\n\t\t\t\t\t});\n\t\t\t\t\tbreak;\n\t\t\t}\n\t\t}\n\t}\n}\n"],"names":["getApplicationInfo","common","uni"],"mappings":";;;;AAOA,MAAe,SAAA,OAAO,MAAmB,SAAiB,aAAqB,YAAoB,mBAAgD;AAC/I,MAAI,kBAAkBA,eAAAA;AACP,oBAAA;AAAA,IACjB,IAAI;AAAA,IACJ,MAAM;AAAA,IACN,YAAY;AAAA,EAAA;AAGT,MAAA,gBAAgB,eAAe,UAAU;AAE5C,UAAM,WAAW,MAAMC,WAAO,OAAA,eAAe,MAAM,cAAc;AACjE,WAAO,SAAS,CAAC;AAAA,EAAA,OACX;AAGN,UAAM,gBAAgB,MAAMA,kBAAO,cAAc,CAAC;AAAA,MACjD,WAAW;AAAA,MACX,MAAM;AAAA,IACN,CAAA,CAAC;AAGF,QAAI,CAAC,iBAAiB,cAAc,KAAK,WAAW,GAAG;AACtD;AAAA,IACD;AAEW,eAAA,aAAa,cAAc,MAAM;AAC3C,cAAQ,gBAAgB,YAAY;AAAA,QACnC,KAAK;AACE,gBAAAA,WAAA,OAAO,UAAU,MAAM,aAAa,UAAU,WAAW,cAAc,SAAS,cAAc;AAEpG,iBAAO,UAAU;AAAA,QAClB;AACCC,wBAAAA,MAAI,UAAU;AAAA,YACV,OAAO;AAAA,YACP,MAAM;AAAA,UAAA,CACT;AACD;AAAA,MACF;AAAA,IACD;AAAA,EACD;AACD;;"}