{"version":3,"file":"avatar.js","sources":["components/user/avatar.vue","/Users/wangshuli/workspace/mine/pighand/pighand-AIO/client-applet/components/user/avatar.vue?type=component"],"sourcesContent":["<template>\n    <view class=\"avatar-wrapper\">\n        <slot></slot>\n\n        <button v-if=\"!avatar\" class=\"overlay-button\" open-type=\"chooseAvatar\" @chooseavatar=\"finishChooseAvatar\"></button>\n    </view>\n</template>\n\n<script setup>\nimport {getUserInfo,setUserInfo} from '@/common/storage'\nimport upload from '@/common/upload'\nimport * as API from '@/api/index';\nconst {avatar} = getUserInfo()\n\nconst finishChooseAvatar = async (params) => {\n\tuni.showLoading({\n\t\ttitle: \"头像上传中\"\n\t});\n\t\n\tconst filePath = params.detail.avatarUrl;\n\tconst fileExt = filePath.split('.')[1];\n\tconst contentType = 'image/jpeg';\n\t\n\tconst fileBuffer = uni.getFileSystemManager().readFileSync(filePath)\n\n\tconst url = await upload(fileBuffer, fileExt, contentType, 'avatar');\n\tawait API.user.updateSelf({\n\t\textension: {\n\t\t\tprofile: url\n\t\t}\n\t})\n\t\r\n\tsetUserInfo({\r\n\t\t...getUserInfo(),\r\n\t\tprofile: url\r\n\t});\n\t\n\tuni.hideLoading();\n}\n</script>\n\n<style scoped>\n.avatar-wrapper {\n    position: relative;\n}\n\n.overlay-button {\n    position: absolute;\n    top: 0;\n    left: 0;\n    width: 100%;\n    height: 100%;\n    opacity: 0;\n    z-index: 1;\n}\n</style> ","import Component from '/Users/wangshuli/workspace/mine/pighand/pighand-AIO/client-applet/components/user/avatar.vue'\nwx.createComponent(Component)"],"names":["getUserInfo","uni","upload","API.user","setUserInfo"],"mappings":";;;;;;;;AAYA,UAAM,EAAC,OAAM,IAAIA,2BAAa;AAE9B,UAAM,qBAAqB,OAAO,WAAW;AAC5CC,oBAAAA,MAAI,YAAY;AAAA,QACf,OAAO;AAAA,MACT,CAAE;AAED,YAAM,WAAW,OAAO,OAAO;AAC/B,YAAM,UAAU,SAAS,MAAM,GAAG,EAAE,CAAC;AACrC,YAAM,cAAc;AAEpB,YAAM,aAAaA,cAAG,MAAC,qBAAoB,EAAG,aAAa,QAAQ;AAEnE,YAAM,MAAM,MAAMC,qBAAO,YAAY,SAAS,aAAa,QAAQ;AACnE,YAAMC,SAAAA,KAAS,WAAW;AAAA,QACzB,WAAW;AAAA,UACV,SAAS;AAAA,QACT;AAAA,MACH,CAAE;AAEDC,iCAAY;AAAA,QACX,GAAGJ,2BAAa;AAAA,QAChB,SAAS;AAAA,MACX,CAAE;AAEDC,oBAAG,MAAC,YAAW;AAAA,IAChB;;;;;;;;;;;ACrCA,GAAG,gBAAgB,SAAS;"}