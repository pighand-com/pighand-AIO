{"version":3,"file":"queue-setting.js","sources":["pages/ECommerce/pages/queue-setting.vue","pages/ECommerce/pages/queue-setting.vue?type=page"],"sourcesContent":["<template>\n  <custom-navigation-bar :back=\"true\" position=\"flex\" title=\"排队设置\" />\n\n  <view class=\"queue-setting-page\">\n    <view class=\"theme-list\">\n      <view \n        v-for=\"theme in themeList\" \n        :key=\"theme.id\" \n        class=\"theme-item\"\n        @click=\"openQueueSetting(theme)\"\n      >\n        <view class=\"theme-image\">\n          <image \n            :src=\"theme.posterUrl\" \n            class=\"theme-img\"\n            mode=\"aspectFill\"\n          />\n        </view>\n        <view class=\"theme-info\">\n          <view class=\"theme-name\">{{ theme.themeName }}</view>\n          <view class=\"queue-duration\">\n            排队时间：{{ theme.queueDuration || 0 }}分钟\n          </view>\n        </view>\n        <view class=\"setting-icon\">\n          <text class=\"icon\">></text>\n        </view>\n      </view>\n    </view>\n    \n    <view v-if=\"themeList.length === 0\" class=\"empty-state\">\n      <text>暂无主题</text>\n    </view>\n  </view>\n\n  <!-- 排队时间设置弹窗 -->\n  <uni-popup ref=\"queuePopup\" type=\"center\">\n    <view class=\"popup-content\">\n      <view class=\"popup-title\">设置排队时间</view>\n      <view class=\"popup-subtitle\">{{ currentTheme?.themeName }}</view>\n      <view class=\"input-section\">\n        <view class=\"input-label\">排队时间（分钟）</view>\n        <input \n          v-model=\"inputQueueDuration\" \n          type=\"number\" \n          placeholder=\"请输入排队时间\"\n          class=\"duration-input\"\n        />\n      </view>\n      <view class=\"popup-buttons\">\n        <button class=\"cancel-btn\" @click=\"closePopup\">取消</button>\n        <button class=\"confirm-btn\" @click=\"submitQueueDuration\">提交</button>\n      </view>\n    </view>\n  </uni-popup>\n</template>\n\n<script setup>\nimport { onLoad } from '@dcloudio/uni-app'\nimport { ref } from 'vue'\nimport { theme as themeAPI } from '@/api'\n\nconst themeList = ref([])\nconst currentTheme = ref(null)\nconst inputQueueDuration = ref('')\nconst queuePopup = ref(null)\n\n// 查询主题列表\nconst queryThemes = async () => {\n  try {\n    const response = await themeAPI.query()\n    if (response && response.records) {\n      themeList.value = response.records\n    } else if (response && Array.isArray(response)) {\n      themeList.value = response\n    }\n  } catch (error) {\n    console.error('查询主题列表失败:', error)\n    uni.showToast({\n      title: '查询失败',\n      icon: 'none'\n    })\n  }\n}\n\n// 打开排队设置弹窗\nconst openQueueSetting = (theme) => {\n  currentTheme.value = theme\n  inputQueueDuration.value = theme.queueDuration || ''\n  queuePopup.value.open()\n}\n\n// 关闭弹窗\nconst closePopup = () => {\n  queuePopup.value.close()\n  currentTheme.value = null\n  inputQueueDuration.value = ''\n}\n\n// 提交排队时间\nconst submitQueueDuration = async () => {\n  if (!inputQueueDuration.value || inputQueueDuration.value < 0) {\n    uni.showToast({\n      title: '请输入有效的排队时间',\n      icon: 'none'\n    })\n    return\n  }\n\n  try {\n    uni.showLoading({\n      title: '设置中...'\n    })\n\n    await themeAPI.updateQueueDuration(currentTheme.value.id, Number(inputQueueDuration.value))\n\n    // 更新本地数据\n    const themeIndex = themeList.value.findIndex(item => item.id === currentTheme.value.id)\n    if (themeIndex !== -1) {\n      themeList.value[themeIndex].queueDuration = Number(inputQueueDuration.value)\n    }\n\n    uni.hideLoading()\n    uni.showToast({\n      title: '设置成功',\n      icon: 'success'\n    })\n    \n    closePopup()\n  } catch (error) {\n    uni.hideLoading()\n    console.error('设置排队时间失败:', error)\n    uni.showToast({\n      title: '设置失败',\n      icon: 'none'\n    })\n  }\n}\n\nonLoad(() => {\n  queryThemes()\n})\n</script>\n\n<style scoped>\n.queue-setting-page {\n  padding: 20rpx;\n  background-color: #f5f5f5;\n  min-height: 100vh;\n}\n\n.theme-list {\n  display: flex;\n  flex-direction: column;\n  gap: 20rpx;\n}\n\n.theme-item {\n  display: flex;\n  align-items: center;\n  background-color: #fff;\n  border-radius: 16rpx;\n  padding: 20rpx;\n  box-shadow: 0 2rpx 8rpx rgba(0, 0, 0, 0.1);\n}\n\n.theme-image {\n  width: 120rpx;\n  height: 120rpx;\n  margin-right: 20rpx;\n}\n\n.theme-img {\n  width: 100%;\n  height: 100%;\n  border-radius: 12rpx;\n}\n\n.theme-info {\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  justify-content: center;\n}\n\n.theme-name {\n  font-size: 32rpx;\n  font-weight: 600;\n  color: #333;\n  margin-bottom: 16rpx;\n  line-height: 1.4;\n}\n\n.queue-duration {\n  font-size: 28rpx;\n  color: #666;\n  line-height: 1.3;\n}\n\n.setting-icon {\n  width: 40rpx;\n  display: flex;\n  justify-content: center;\n  align-items: center;\n}\n\n.icon {\n  font-size: 32rpx;\n  color: #999;\n}\n\n.empty-state {\n  display: flex;\n  justify-content: center;\n  align-items: center;\n  height: 400rpx;\n  color: #999;\n  font-size: 28rpx;\n}\n\n/* 弹窗样式 */\n.popup-content {\n  width: 600rpx;\n  background-color: #fff;\n  border-radius: 20rpx;\n  padding: 40rpx;\n}\n\n.popup-title {\n  font-size: 36rpx;\n  font-weight: 600;\n  color: #333;\n  text-align: center;\n  margin-bottom: 16rpx;\n}\n\n.popup-subtitle {\n  font-size: 28rpx;\n  color: #666;\n  text-align: center;\n  margin-bottom: 40rpx;\n}\n\n.input-section {\n  margin-bottom: 40rpx;\n}\n\n.input-label {\n  font-size: 28rpx;\n  color: #333;\n  margin-bottom: 16rpx;\n}\n\n.duration-input {\n  width: 100%;\n  height: 80rpx;\n  border: 2rpx solid #e5e5e5;\n  border-radius: 12rpx;\n  padding: 0 20rpx;\n  font-size: 28rpx;\n  box-sizing: border-box;\n}\n\n.duration-input:focus {\n  border-color: #007aff;\n}\n\n.popup-buttons {\n  display: flex;\n  gap: 20rpx;\n}\n\n.cancel-btn,\n.confirm-btn {\n  flex: 1;\n  height: 80rpx;\n  border-radius: 12rpx;\n  font-size: 28rpx;\n  border: none;\n}\n\n.cancel-btn {\n  background-color: #f5f5f5;\n  color: #666;\n}\n\n.confirm-btn {\n  background-color: #007aff;\n  color: #fff;\n}\n</style>","import MiniProgramPage from '/Users/wangshuli/workspace/mine/pighand/pighand-AIO/client-applet/pages/ECommerce/pages/queue-setting.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","themeAPI","uni","onLoad"],"mappings":";;;;;;;;;;;;;;;;AA8DA,UAAM,YAAYA,cAAG,IAAC,EAAE;AACxB,UAAM,eAAeA,cAAG,IAAC,IAAI;AAC7B,UAAM,qBAAqBA,cAAG,IAAC,EAAE;AACjC,UAAM,aAAaA,cAAG,IAAC,IAAI;AAG3B,UAAM,cAAc,YAAY;AAC9B,UAAI;AACF,cAAM,WAAW,MAAMC,UAAQ,SAAC,MAAO;AACvC,YAAI,YAAY,SAAS,SAAS;AAChC,oBAAU,QAAQ,SAAS;AAAA,QAC5B,WAAU,YAAY,MAAM,QAAQ,QAAQ,GAAG;AAC9C,oBAAU,QAAQ;AAAA,QACnB;AAAA,MACF,SAAQ,OAAO;AACdC,sBAAAA,MAAA,MAAA,SAAA,iDAAc,aAAa,KAAK;AAChCA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AAAA,MACF;AAAA,IACH;AAGA,UAAM,mBAAmB,CAAC,UAAU;AAClC,mBAAa,QAAQ;AACrB,yBAAmB,QAAQ,MAAM,iBAAiB;AAClD,iBAAW,MAAM,KAAM;AAAA,IACzB;AAGA,UAAM,aAAa,MAAM;AACvB,iBAAW,MAAM,MAAO;AACxB,mBAAa,QAAQ;AACrB,yBAAmB,QAAQ;AAAA,IAC7B;AAGA,UAAM,sBAAsB,YAAY;AACtC,UAAI,CAAC,mBAAmB,SAAS,mBAAmB,QAAQ,GAAG;AAC7DA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AACD;AAAA,MACD;AAED,UAAI;AACFA,sBAAAA,MAAI,YAAY;AAAA,UACd,OAAO;AAAA,QACb,CAAK;AAED,cAAMD,UAAQ,SAAC,oBAAoB,aAAa,MAAM,IAAI,OAAO,mBAAmB,KAAK,CAAC;AAG1F,cAAM,aAAa,UAAU,MAAM,UAAU,UAAQ,KAAK,OAAO,aAAa,MAAM,EAAE;AACtF,YAAI,eAAe,IAAI;AACrB,oBAAU,MAAM,UAAU,EAAE,gBAAgB,OAAO,mBAAmB,KAAK;AAAA,QAC5E;AAEDC,sBAAAA,MAAI,YAAa;AACjBA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AAED,mBAAY;AAAA,MACb,SAAQ,OAAO;AACdA,sBAAAA,MAAI,YAAa;AACjBA,sBAAAA,MAAA,MAAA,SAAA,kDAAc,aAAa,KAAK;AAChCA,sBAAAA,MAAI,UAAU;AAAA,UACZ,OAAO;AAAA,UACP,MAAM;AAAA,QACZ,CAAK;AAAA,MACF;AAAA,IACH;AAEAC,kBAAAA,OAAO,MAAM;AACX,kBAAa;AAAA,IACf,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5ID,GAAG,WAAW,eAAe;"}