{"version":3,"file":"ticket-list.js","sources":["pages/ECommerce/pages/ticket-list.vue","pages/ECommerce/pages/ticket-list.vue?type=page"],"sourcesContent":["<template>\n\t<view class=\"content\">\n        <custom-navigation-bar position=\"flex\" title=\"票务列表\" />\n\n\t\t<!-- 票务列表 -->\n\t\t<view class=\"ticket-list\">\n\t\t\t<view class=\"ticket-item\" \n\t\t\t\t  v-for=\"ticket in ticketList\" \n\t\t\t\t  :key=\"ticket.id\">\n\t\t\t\t<!-- 封面图 -->\n\t\t\t\t<view class=\"ticket-cover\" v-if=\"ticket.posterUrl\">\n\t\t\t\t\t<image :src=\"ticket.posterUrl\" \n\t\t\t\t\t\t   class=\"cover-image\" \n\t\t\t\t\t\t   mode=\"aspectFill\"></image>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<!-- 票务信息 -->\n\t\t\t\t<view class=\"ticket-info\">\n\t\t\t\t\t<text class=\"ticket-name\">{{ ticket.name }}</text>\n\t\t\t\t\t\n\t\t\t\t\t<!-- 价格信息 -->\n\t\t\t\t\t<view class=\"price-info\">\n\t\t\t\t\t\t<!-- 有原价且与现价不同时显示原价 -->\n\t\t\t\t\t\t<text class=\"original-price\" \n\t\t\t\t\t\t\t  v-if=\"ticket.originalPrice && ticket.originalPrice !== ticket.currentPrice\">\n\t\t\t\t\t\t\t¥{{ formatPrice(ticket.originalPrice) }}\n\t\t\t\t\t\t</text>\n\t\t\t\t\t\t<!-- 现价 -->\n\t\t\t\t\t\t<text class=\"current-price\">\n\t\t\t\t\t\t\t¥{{ formatPrice(ticket.currentPrice) }}\n\t\t\t\t\t\t</text>\n\t\t\t\t\t</view>\n\t\t\t\t</view>\n\t\t\t\t\n\t\t\t\t<!-- 立即购买按钮 -->\n\t\t\t\t<view class=\"buy-button\" @click=\"goToDetail(ticket.id)\">\n\t\t\t\t\t<text class=\"buy-text\">立即购买</text>\n\t\t\t\t</view>\n\t\t\t</view>\n\t\t</view>\n\t\t\n\t\t<!-- 空状态 -->\n\t\t<view class=\"empty-state\" v-if=\"ticketList.length === 0 && !isLoading\">\n\t\t\t<text class=\"empty-text\">暂无票务信息</text>\n\t\t</view>\n\t\t\n\t\t<tab-bar />\n\t\t\n\t\t<!-- 加载状态 -->\n\t\t<view class=\"loading-state\" v-if=\"isLoading\">\n\t\t\t<text class=\"loading-text\">加载中...</text>\n\t\t</view>\n\t</view>\n</template>\n\n<script setup>\nimport { onLoad } from '@dcloudio/uni-app'\nimport { ref } from 'vue'\nimport Decimal from 'decimal.js'\nimport { ticket as ticketAPI } from '@/api'\n\n// 票务列表数据\nconst ticketList = ref([])\nconst isLoading = ref(false)\n\nonLoad((options) => {\n\tgetTicketList()\n})\n\n// 获取票务列表\nconst getTicketList = async () => {\n\tisLoading.value = true\n\ttry {\n\t\tconst res = await ticketAPI.query({})\n\t\tticketList.value = res.records || []\n\t} catch (error) {\n\t\tconsole.error('获取票务列表失败:', error)\n\t\tuni.showToast({\n\t\t\ttitle: '获取票务列表失败',\n\t\t\ticon: 'none'\n\t\t})\n\t} finally {\n\t\tisLoading.value = false\n\t}\n}\n\n// 格式化价格（分转元）\nconst formatPrice = (price) => {\n\tif (!price) return '0'\n\treturn new Decimal(price).div(100).toNumber()\n}\n\n// 跳转到票务详情\nconst goToDetail = (ticketId) => {\n\tuni.navigateTo({\n\t\turl: `/pages/ECommerce/pages/ticket-detail?id=${ticketId}`\n\t})\n}\n</script>\n\n<style scoped>\n.content {\n\tbackground-color: #f5f5f5;\n\tposition: relative;\n\theight: 100vh;\n\tdisplay: flex;\n\tflex-direction: column;\n}\n\n.ticket-list {\n\tpadding: 20rpx;\n\tflex: 1;\n\toverflow-y: auto;\n\tpadding-bottom: calc(100rpx + env(safe-area-inset-bottom) + 20rpx);\n}\n\n.ticket-item {\n\tdisplay: flex;\n\talign-items: center;\n\tbackground-color: #fff;\n\tborder-radius: 20rpx;\n\tpadding: 30rpx;\n\tmargin-bottom: 20rpx;\n\tbox-shadow: 0 4rpx 20rpx rgba(0, 0, 0, 0.05);\n\ttransition: all 0.3s ease;\n}\n\n.ticket-item:active {\n\ttransform: scale(0.98);\n\tbackground-color: #f8f8f8;\n}\n\n.ticket-cover {\n\twidth: 240rpx;\n\theight: 140rpx;\n\tborder-radius: 12rpx;\n\toverflow: hidden;\n\tmargin-right: 40rpx;\n\tflex-shrink: 0;\n}\n\n.ticket-item:not(:has(.ticket-cover)) .ticket-info {\n\tmargin-left: 0;\n}\n\n.cover-image {\n\twidth: 100%;\n\theight: 100%;\n}\n\n.ticket-info {\n\tflex: 1;\n\tdisplay: flex;\n\tflex-direction: column;\n\tjustify-content: center;\n}\n\n.ticket-name {\n\tfont-size: 32rpx;\n\tfont-weight: bold;\n\tcolor: #333;\n\tmargin-bottom: 15rpx;\n\tline-height: 1.4;\n}\n\n.price-info {\n\tdisplay: flex;\n\talign-items: center;\n\tgap: 15rpx;\n}\n\n.original-price {\n\tfont-size: 24rpx;\n\tcolor: #999;\n\ttext-decoration: line-through;\n}\n\n.current-price {\n\tfont-size: 28rpx;\n\tfont-weight: bold;\n\tcolor: #ff4444;\n}\n\n.buy-button {\n\tpadding: 15rpx 25rpx;\n\tbackground: linear-gradient(135deg, #ff8c00 0%, #ff6b00 100%);\n\tborder-radius: 25rpx;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tflex-shrink: 0;\n\tbox-shadow: 0 4rpx 15rpx rgba(255, 140, 0, 0.3);\n\ttransition: all 0.3s ease;\n}\n\n.buy-button:active {\n\ttransform: scale(0.95);\n}\n\n.buy-text {\n\tfont-size: 24rpx;\n\tcolor: #ffffff;\n\tfont-weight: bold;\n}\n\n.empty-state {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\theight: 400rpx;\n}\n\n.empty-text {\n\tfont-size: 28rpx;\n\tcolor: #999;\n}\n\n.loading-state {\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\theight: 400rpx;\n}\n\n.loading-text {\n\tfont-size: 28rpx;\n\tcolor: #999;\n}\n</style>","import MiniProgramPage from '/Users/wangshuli/workspace/mine/pighand/pighand-AIO/client-applet/pages/ECommerce/pages/ticket-list.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","onLoad","ticketAPI","uni","Decimal"],"mappings":";;;;;;;;;;;;;;;;AA8DA,UAAM,aAAaA,cAAG,IAAC,EAAE;AACzB,UAAM,YAAYA,cAAG,IAAC,KAAK;AAE3BC,kBAAM,OAAC,CAAC,YAAY;AACnB,oBAAe;AAAA,IAChB,CAAC;AAGD,UAAM,gBAAgB,YAAY;AACjC,gBAAU,QAAQ;AAClB,UAAI;AACH,cAAM,MAAM,MAAMC,qBAAU,MAAM,CAAA,CAAE;AACpC,mBAAW,QAAQ,IAAI,WAAW,CAAE;AAAA,MACpC,SAAQ,OAAO;AACfC,sBAAAA,oEAAc,aAAa,KAAK;AAChCA,sBAAAA,MAAI,UAAU;AAAA,UACb,OAAO;AAAA,UACP,MAAM;AAAA,QACT,CAAG;AAAA,MACH,UAAW;AACT,kBAAU,QAAQ;AAAA,MAClB;AAAA,IACF;AAGA,UAAM,cAAc,CAAC,UAAU;AAC9B,UAAI,CAAC;AAAO,eAAO;AACnB,aAAO,IAAIC,cAAO,QAAC,KAAK,EAAE,IAAI,GAAG,EAAE,SAAU;AAAA,IAC9C;AAGA,UAAM,aAAa,CAAC,aAAa;AAChCD,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,2CAA2C,QAAQ;AAAA,MAC1D,CAAE;AAAA,IACF;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AChGA,GAAG,WAAW,eAAe;"}