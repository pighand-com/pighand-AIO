{"version":3,"file":"index.js","sources":["pages/base/pages/index.vue","pages/base/pages/index.vue?type=page"],"sourcesContent":["<template>\r\n\t<view class=\"content\">\r\n\t\t<!-- Banner轮播图 -->\r\n\t\t<view class=\"banner-container\" v-if=\"bannerList.length > 0\">\r\n\t\t\t<swiper class=\"banner-swiper\" :autoplay=\"true\" :interval=\"3000\" :duration=\"500\">\r\n\t\t\t\t<swiper-item v-for=\"(banner, index) in bannerList\" :key=\"index\">\r\n\t\t\t\t\t<image :src=\"banner.imageUrl || banner.image\" class=\"banner-image\" mode=\"aspectFill\"></image>\r\n\t\t\t\t</swiper-item>\r\n\t\t\t</swiper>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 主题购买按钮 -->\r\n\t\t<view class=\"theme-container\">\r\n\t\t\t<custom-button \r\n\t\t\t\ttext=\"立即购买\" \r\n\t\t\t\twidth=\"360rpx\" \r\n\t\t\t\tfontSize=\"48rpx\"\r\n\t\t\t\t@click=\"handleBuyNow\" \r\n\t\t\t/>\r\n\t\t</view>\r\n\t\t\r\n\t\t<!-- 查看排队时间按钮 -->\r\n\t\t<view class=\"queue-button-container\">\r\n\t\t\t<custom-button \r\n\t\t\t\ttext=\"查看排队时间\" \r\n\t\t\t\twidth=\"280rpx\" \r\n\t\t\t\tfontSize=\"32rpx\"\r\n\t\t\t\t@click=\"showQueuePopup\" \r\n\t\t\t/>\r\n\t\t</view>\r\n\t</view>\r\n\r\n\t<!-- 排队时间弹出层 -->\r\n\t<uni-popup ref=\"queuePopup\" type=\"center\" :mask-click=\"true\">\r\n\t\t<view class=\"queue-popup\">\r\n\t\t\t<view class=\"queue-popup-header\">\r\n\t\t\t\t<text class=\"queue-popup-title\">排队时间</text>\r\n\t\t\t</view>\r\n\t\t\t<view class=\"queue-popup-content\">\r\n\t\t\t\t<view v-if=\"themeList.length === 0\" class=\"no-data\">\r\n\t\t\t\t\t<text>暂无主题数据</text>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view v-else class=\"queue-list\">\r\n\t\t\t\t\t<view v-for=\"(theme, index) in themeList\" :key=\"index\" class=\"queue-item\">\r\n\t\t\t\t\t\t<view class=\"theme-info\">\r\n\t\t\t\t\t\t\t<text class=\"theme-name\">{{ theme.themeName || theme.name || '未知主题' }}</text>\r\n\t\t\t\t\t\t\t<text class=\"queue-duration\">{{ formatQueueDuration(theme.queueDuration || 0) }}</text>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t</view>\r\n\t\t</view>\r\n\t</uni-popup>\r\n\r\n\t<tab-bar />\r\n</template>\r\n\r\n<script setup>\r\nimport { ref } from 'vue'\r\nimport { onLoad } from '@dcloudio/uni-app'\r\nimport { banner as bannerAPI, theme as themeAPI } from '@/api'\r\nimport { setFromSalesId } from '@/common/storage'\r\n\r\nconst bannerList = ref([])\r\nconst themeList = ref([])\r\nconst queuePopup = ref(null)\r\n\r\n// 格式化排队时间显示\r\nconst formatQueueDuration = (minutes) => {\r\n\tif (minutes >= 60) {\r\n\t\tconst hours = Math.floor(minutes / 60)\r\n\t\tconst remainingMinutes = minutes % 60\r\n\t\tif (remainingMinutes === 0) {\r\n\t\t\treturn `${hours}小时`\r\n\t\t} else {\r\n\t\t\treturn `${hours}小时${remainingMinutes}分钟`\r\n\t\t}\r\n\t} else {\r\n\t\treturn `${minutes}分钟`\r\n\t}\r\n}\r\n\r\n// 获取banner列表\r\nconst getBannerList = async () => {\r\n\ttry {\r\n\t\tconst res = await bannerAPI.query()\r\n\t\tif (res && res.records) {\r\n\t\t\tbannerList.value = res.records\r\n\t\t}\r\n\t} catch (error) {\r\n\t\tconsole.error('获取banner列表失败:', error)\r\n\t}\r\n}\r\n\r\n// 获取主题列表\r\nconst getThemeList = async () => {\r\n\ttry {\r\n\t\tconst res = await themeAPI.query()\r\n\t\tif (res && res.records) {\r\n\t\t\tthemeList.value = res.records\r\n\t\t}\r\n\t} catch (error) {\r\n\t\tconsole.error('获取主题列表失败:', error)\r\n\t}\r\n}\r\n\r\n// 立即购买按钮点击事件\r\nconst handleBuyNow = () => {\n\tconst themeId = themeList.value[0].id\r\n\tuni.navigateTo({\r\n\t\turl: `/pages/ECommerce/pages/theme?id=${themeId}`\r\n\t})\r\n}\r\n\r\n// 显示排队时间弹出层\r\nconst showQueuePopup = async () => {\r\n\t// 重新获取最新的主题数据\r\n\tawait getThemeList()\r\n\tqueuePopup.value.open()\r\n}\r\n\r\n// 关闭排队时间弹出层\r\nconst closeQueuePopup = () => {\r\n\tqueuePopup.value.close()\r\n}\r\n\r\n// 页面加载时获取参数\r\nonLoad((options) => {\r\n\tconst { scene = ''} = options;\r\n\t// 检查是否有sales参数\r\n\tconst sales = scene && decodeURIComponent(scene).split('=')[1]\r\n\tif(sales) {\r\n\t\tsetFromSalesId(sales)\r\n\t}\r\n\t\r\n\t// 获取数据\r\n\tgetBannerList()\r\n\tgetThemeList()\r\n})\r\n\r\n</script>\r\n\r\n<style>\r\n.content {\r\n\tpadding: 0;\r\n\tposition: relative;\r\n\theight: calc(100vh - 100rpx);\r\n}\r\n\r\n.banner-container {\r\n\twidth: 100%;\r\n\theight: calc(100vh - 100rpx);\r\n\tposition: absolute;\r\n\ttop: 0;\r\n\tleft: 0;\r\n\tz-index: 1;\r\n}\r\n\r\n.banner-swiper {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n}\r\n\r\n.banner-image {\r\n\twidth: 100%;\r\n\theight: 100%;\r\n\tborder-radius: 0;\r\n}\r\n\r\n/* 轮播指示点样式 */\r\n.banner-swiper ::v-deep .uni-swiper-dot {\r\n\tbackground-color: rgba(255, 255, 255, 0.5);\r\n}\r\n\r\n.banner-swiper ::v-deep .uni-swiper-dot-active {\r\n\tbackground-color: #ffffff;\r\n}\r\n\r\n/* 主题购买按钮样式 */\r\n.theme-container {\r\n\tposition: fixed;\r\n\ttop: 50%;\r\n\tleft: 50%;\r\n\ttransform: translate(-50%, -50%);\r\n\tz-index: 10;\r\n\ttext-align: center;\r\n}\r\n\r\n/* 按钮样式已移至组件内部 */\r\n\r\n/* 查看排队时间按钮样式 */\r\n.queue-button-container {\r\n\tposition: fixed;\r\n\ttop: calc(50% + 120rpx);\r\n\tleft: 50%;\r\n\ttransform: translateX(-50%);\r\n\tz-index: 10;\r\n\ttext-align: center;\r\n}\r\n\r\n/* 排队时间弹出层样式 */\r\n.queue-popup {\r\n\twidth: 600rpx;\r\n\tbackground-color: #ffffff;\r\n\tborder-radius: 20rpx;\r\n\toverflow: hidden;\r\n}\r\n\r\n.queue-popup-header {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n\tpadding: 30rpx 40rpx;\r\n\tbackground-color: #f8f9fa;\r\n\tborder-bottom: 1rpx solid #e9ecef;\r\n}\r\n\r\n.queue-popup-title {\r\n\tfont-size: 36rpx;\r\n\tfont-weight: bold;\r\n\tcolor: #333333;\r\n}\r\n\r\n.close-icon {\r\n\tfont-size: 40rpx;\r\n\tcolor: #666666;\r\n\tline-height: 1;\r\n}\r\n\r\n.queue-popup-content {\r\n\tpadding: 40rpx;\r\n\tmax-height: 800rpx;\r\n\toverflow-y: auto;\r\n}\r\n\r\n.no-data {\r\n\ttext-align: center;\r\n\tpadding: 80rpx 0;\r\n\tcolor: #999999;\r\n\tfont-size: 28rpx;\r\n}\r\n\r\n.queue-list {\r\n\tdisplay: flex;\r\n\tflex-direction: column;\r\n\tgap: 20rpx;\r\n}\r\n\r\n.queue-item {\r\n\tpadding: 30rpx;\r\n\tbackground-color: #f8f9fa;\r\n\tborder-radius: 12rpx;\r\n\tborder: 1rpx solid #e9ecef;\r\n}\r\n\r\n.theme-info {\r\n\tdisplay: flex;\r\n\tjustify-content: space-between;\r\n\talign-items: center;\r\n}\r\n\r\n.theme-name {\r\n\tfont-size: 32rpx;\r\n\tcolor: #333333;\r\n\tfont-weight: 500;\r\n\tflex: 1;\r\n}\r\n\r\n.queue-duration {\r\n\tfont-size: 28rpx;\r\n\tcolor: #007aff;\r\n\tfont-weight: bold;\r\n}\r\n</style>\r\n","import MiniProgramPage from '/Users/wangshuli/workspace/mine/pighand/pighand-AIO/client-applet/pages/base/pages/index.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","bannerAPI","uni","themeAPI","onLoad","setFromSalesId","MiniProgramPage"],"mappings":";;;;;;;;;;;;;;;;;;;;AA+DA,UAAM,aAAaA,cAAG,IAAC,EAAE;AACzB,UAAM,YAAYA,cAAG,IAAC,EAAE;AACxB,UAAM,aAAaA,cAAG,IAAC,IAAI;AAG3B,UAAM,sBAAsB,CAAC,YAAY;AACxC,UAAI,WAAW,IAAI;AAClB,cAAM,QAAQ,KAAK,MAAM,UAAU,EAAE;AACrC,cAAM,mBAAmB,UAAU;AACnC,YAAI,qBAAqB,GAAG;AAC3B,iBAAO,GAAG,KAAK;AAAA,QAClB,OAAS;AACN,iBAAO,GAAG,KAAK,KAAK,gBAAgB;AAAA,QACpC;AAAA,MACH,OAAQ;AACN,eAAO,GAAG,OAAO;AAAA,MACjB;AAAA,IACF;AAGA,UAAM,gBAAgB,YAAY;AACjC,UAAI;AACH,cAAM,MAAM,MAAMC,WAAS,UAAC,MAAO;AACnC,YAAI,OAAO,IAAI,SAAS;AACvB,qBAAW,QAAQ,IAAI;AAAA,QACvB;AAAA,MACD,SAAQ,OAAO;AACfC,sBAAAA,MAAc,MAAA,SAAA,oCAAA,iBAAiB,KAAK;AAAA,MACpC;AAAA,IACF;AAGA,UAAM,eAAe,YAAY;AAChC,UAAI;AACH,cAAM,MAAM,MAAMC,UAAQ,SAAC,MAAO;AAClC,YAAI,OAAO,IAAI,SAAS;AACvB,oBAAU,QAAQ,IAAI;AAAA,QACtB;AAAA,MACD,SAAQ,OAAO;AACfD,sBAAAA,0DAAc,aAAa,KAAK;AAAA,MAChC;AAAA,IACF;AAGA,UAAM,eAAe,MAAM;AAC1B,YAAM,UAAU,UAAU,MAAM,CAAC,EAAE;AACnCA,oBAAAA,MAAI,WAAW;AAAA,QACd,KAAK,mCAAmC,OAAO;AAAA,MACjD,CAAE;AAAA,IACF;AAGA,UAAM,iBAAiB,YAAY;AAElC,YAAM,aAAc;AACpB,iBAAW,MAAM,KAAM;AAAA,IACxB;AAQAE,kBAAM,OAAC,CAAC,YAAY;AACnB,YAAM,EAAE,QAAQ,GAAE,IAAI;AAEtB,YAAM,QAAQ,SAAS,mBAAmB,KAAK,EAAE,MAAM,GAAG,EAAE,CAAC;AAC7D,UAAG,OAAO;AACTC,uBAAAA,eAAe,KAAK;AAAA,MACpB;AAGD,oBAAe;AACf,mBAAc;AAAA,IACf,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;ACzID,GAAG,WAAWC,SAAe;"}