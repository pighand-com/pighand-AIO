{"version":3,"file":"webview.js","sources":["pages/base/pages/webview.vue","pages/base/pages/webview.vue?type=page"],"sourcesContent":["<template>\n\t<view class=\"webview-container\">\n\t\t<!-- 自定义导航栏 -->\n\t\t<custom-navigation-bar position=\"flex\" :title=\"pageTitle\" />\n\t\t\n\t\t<!-- WebView内容区域 -->\n\t\t<view class=\"webview-content\">\n\t\t\t<web-view \n\t\t\t\t:src=\"webviewUrl\" \n\t\t\t\t@message=\"handleMessage\"\n\t\t\t\t@error=\"handleError\"\n\t\t\t\t@load=\"handleLoad\"\n\t\t\t\t@loading=\"handleLoading\"\n\t\t\t></web-view>\n\t\t</view>\n\t\t\n\t\t<!-- 加载状态 -->\n\t\t<view v-if=\"isLoading\" class=\"loading-container\">\n\t\t\t<uni-load-more status=\"loading\" :content-text=\"loadingText\"></uni-load-more>\n\t\t</view>\n\t\t\n\t\t<!-- 错误状态 -->\n\t\t<view v-if=\"hasError\" class=\"error-container\">\n\t\t\t<view class=\"error-content\">\n\t\t\t\t<text class=\"error-icon\">⚠️</text>\n\t\t\t\t<text class=\"error-title\">页面加载失败</text>\n\t\t\t\t<text class=\"error-message\">{{ errorMessage }}</text>\n\t\t\t\t<custom-button \n\t\t\t\t\ttext=\"重新加载\" \n\t\t\t\t\twidth=\"200rpx\" \n\t\t\t\t\tfontSize=\"28rpx\"\n\t\t\t\t\t@click=\"reloadWebview\" \n\t\t\t\t/>\n\t\t\t</view>\n\t\t</view>\n\t</view>\n</template>\n\n<script setup>\nimport { ref } from 'vue'\nimport { onLoad } from '@dcloudio/uni-app'\n\n// 响应式数据\nconst webviewUrl = ref('')\nconst pageTitle = ref('网页浏览')\nconst isLoading = ref(false)\nconst hasError = ref(false)\nconst errorMessage = ref('')\n\n// 加载文本配置\nconst loadingText = ref({\n\tcontentdown: '上拉显示更多',\n\tcontentrefresh: '正在加载...',\n\tcontentnomore: '没有更多数据了'\n})\n\n// WebView事件处理\nconst handleMessage = (event) => {\n\t// 处理来自WebView的消息\n\tconst data = event.detail.data\n\tif (data && data.length > 0) {\n\t\tconst message = data[0]\n\t\t// 根据消息类型处理不同逻辑\n\t\tswitch (message.type) {\n\t\t\tcase 'title':\n\t\t\t\tpageTitle.value = message.title || '网页浏览'\n\t\t\t\tbreak\n\t\t\tcase 'close':\n\t\t\t\tuni.navigateBack()\n\t\t\t\tbreak\n\t\t\tdefault:\n\t\t\t\tconsole.log('未知消息类型:', message)\n\t\t}\n\t}\n}\n\nconst handleError = (event) => {\n\tconsole.error('WebView加载错误:', event)\n\tisLoading.value = false\n\thasError.value = true\n\terrorMessage.value = '网页加载失败，请检查网络连接或稍后重试'\n}\n\nconst handleLoad = (event) => {\n\tisLoading.value = false\n\thasError.value = false\n}\n\nconst handleLoading = (event) => {\n\tisLoading.value = true\n\thasError.value = false\n}\n\n// 重新加载WebView\nconst reloadWebview = () => {\n\thasError.value = false\n\tisLoading.value = true\n\t// 通过重新设置URL来触发重新加载\n\tconst currentUrl = webviewUrl.value\n\twebviewUrl.value = ''\n\tsetTimeout(() => {\n\t\twebviewUrl.value = currentUrl\n\t}, 100)\n}\n\n// 页面生命周期\nonLoad((options) => {\n\t// 获取传入的URL和标题\n\tif (options.url) {\n\t\twebviewUrl.value = decodeURIComponent(options.url)\n\t}\n\t\n\tif (options.title) {\n\t\tpageTitle.value = decodeURIComponent(options.title)\n\t}\n\t\n\t// 如果没有传入URL，显示错误\n\tif (!webviewUrl.value) {\n\t\thasError.value = true\n\t\terrorMessage.value = '缺少必要的URL参数'\n\t\treturn\n\t}\n\t\n\t// 开始加载\n\tisLoading.value = true\n})\n</script>\n\n<style scoped>\n.webview-container {\n\twidth: 100%;\n\theight: 100vh;\n\tdisplay: flex;\n\tflex-direction: column;\n\tbackground-color: #ffffff;\n}\n\n.webview-content {\n\tflex: 1;\n\twidth: 100%;\n\tposition: relative;\n\toverflow: hidden;\n}\n\n.webview-content web-view {\n\twidth: 100%;\n\theight: 100%;\n}\n\n.loading-container {\n\tposition: absolute;\n\ttop: 50%;\n\tleft: 50%;\n\ttransform: translate(-50%, -50%);\n\tz-index: 10;\n\tbackground-color: rgba(255, 255, 255, 0.9);\n\tborder-radius: 12rpx;\n\tpadding: 40rpx;\n}\n\n.error-container {\n\tposition: absolute;\n\ttop: 0;\n\tleft: 0;\n\twidth: 100%;\n\theight: 100%;\n\tdisplay: flex;\n\talign-items: center;\n\tjustify-content: center;\n\tbackground-color: #f8f9fa;\n\tz-index: 10;\n}\n\n.error-content {\n\tdisplay: flex;\n\tflex-direction: column;\n\talign-items: center;\n\tpadding: 60rpx 40rpx;\n\ttext-align: center;\n}\n\n.error-icon {\n\tfont-size: 80rpx;\n\tmargin-bottom: 30rpx;\n}\n\n.error-title {\n\tfont-size: 36rpx;\n\tfont-weight: bold;\n\tcolor: #333333;\n\tmargin-bottom: 20rpx;\n}\n\n.error-message {\n\tfont-size: 28rpx;\n\tcolor: #666666;\n\tline-height: 1.5;\n\tmargin-bottom: 40rpx;\n\tmax-width: 500rpx;\n}\n</style>","import MiniProgramPage from '/Users/wangshuli/workspace/mine/pighand/pighand-AIO/client-applet/pages/base/pages/webview.vue'\nwx.createPage(MiniProgramPage)"],"names":["ref","uni","onLoad"],"mappings":";;;;;;;;;;;;;;;;;AA2CA,UAAM,aAAaA,cAAG,IAAC,EAAE;AACzB,UAAM,YAAYA,cAAG,IAAC,MAAM;AAC5B,UAAM,YAAYA,cAAG,IAAC,KAAK;AAC3B,UAAM,WAAWA,cAAG,IAAC,KAAK;AAC1B,UAAM,eAAeA,cAAG,IAAC,EAAE;AAG3B,UAAM,cAAcA,cAAAA,IAAI;AAAA,MACvB,aAAa;AAAA,MACb,gBAAgB;AAAA,MAChB,eAAe;AAAA,IAChB,CAAC;AAGD,UAAM,gBAAgB,CAAC,UAAU;AAEhC,YAAM,OAAO,MAAM,OAAO;AAC1B,UAAI,QAAQ,KAAK,SAAS,GAAG;AAC5B,cAAM,UAAU,KAAK,CAAC;AAEtB,gBAAQ,QAAQ,MAAI;AAAA,UACnB,KAAK;AACJ,sBAAU,QAAQ,QAAQ,SAAS;AACnC;AAAA,UACD,KAAK;AACJC,0BAAAA,MAAI,aAAc;AAClB;AAAA,UACD;AACCA,0BAAAA,MAAA,MAAA,OAAA,sCAAY,WAAW,OAAO;AAAA,QAC/B;AAAA,MACD;AAAA,IACF;AAEA,UAAM,cAAc,CAAC,UAAU;AAC9BA,oBAAAA,MAAA,MAAA,SAAA,sCAAc,gBAAgB,KAAK;AACnC,gBAAU,QAAQ;AAClB,eAAS,QAAQ;AACjB,mBAAa,QAAQ;AAAA,IACtB;AAEA,UAAM,aAAa,CAAC,UAAU;AAC7B,gBAAU,QAAQ;AAClB,eAAS,QAAQ;AAAA,IAClB;AAEA,UAAM,gBAAgB,CAAC,UAAU;AAChC,gBAAU,QAAQ;AAClB,eAAS,QAAQ;AAAA,IAClB;AAGA,UAAM,gBAAgB,MAAM;AAC3B,eAAS,QAAQ;AACjB,gBAAU,QAAQ;AAElB,YAAM,aAAa,WAAW;AAC9B,iBAAW,QAAQ;AACnB,iBAAW,MAAM;AAChB,mBAAW,QAAQ;AAAA,MACnB,GAAE,GAAG;AAAA,IACP;AAGAC,kBAAM,OAAC,CAAC,YAAY;AAEnB,UAAI,QAAQ,KAAK;AAChB,mBAAW,QAAQ,mBAAmB,QAAQ,GAAG;AAAA,MACjD;AAED,UAAI,QAAQ,OAAO;AAClB,kBAAU,QAAQ,mBAAmB,QAAQ,KAAK;AAAA,MAClD;AAGD,UAAI,CAAC,WAAW,OAAO;AACtB,iBAAS,QAAQ;AACjB,qBAAa,QAAQ;AACrB;AAAA,MACA;AAGD,gBAAU,QAAQ;AAAA,IACnB,CAAC;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC5HD,GAAG,WAAW,eAAe;"}